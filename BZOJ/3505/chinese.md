# BZOJ 3505

## 描述

- [Virtual Judge](https://vjudge.net/problem/HYSBZ-3505)
- [黑暗爆炸OJ](https://darkbzoj.tk/problem/3505)

## 解法

首先，我必须提醒一句：一个 $n\times m$ 的网格有 $n+1$ 条横线（行）和 $m+1$ 条竖线（列）。因此在下文中 $n=n+1$，$m=m+1$。

网格有 $nm$ 个点，可以产生 $\tbinom{nm}{3}$ 种三个点的组合。但是其中三点共线的组合不能构成三角形。我们需要将这些组合剔除掉。

那些同行同列的组合很容易被剔除，但斜着的那些怎么办？我们知道，不同的两点 $(a,b)$ 和 $(c,d)$ 之间的线段上有 $\gcd(|a-c|,|b-d|)-1$ 个整点。我们可以我们可以枚举第二点，找到其与 $(0,0)$ 之间的整点，将这三者构成的组合及能通过平移和翻转其得到的组合剔除掉，来排除所有不合法组合。而对于每条 $(0,0)$ 与 $(i,j)$ 之间的线段，全图中都有 $2(n-i)(m-j)$ 个相同的结构（每个 $i\times j$ 的矩形中有 $(0,0)$ 与 $(i,j)$ 和 $(i,0)$ 与 $(0,j)$ 两种）。

## 代码

- [正解](BZOJ.3505.0.cpp)
