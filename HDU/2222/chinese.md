# HDU 2222

## 描述

- [Virtual Judge](https://vjudge.net/problem/HDU-2222)
- [HDU](http://acm.hdu.edu.cn/showproblem.php?pid=2222)

## 解法

这是一道 <abbr title="Aho-Corasick 自动机算法">AC 自动机</abbr> 的练习题。AC 自动机是一个能利用字典树同时检索多个模式串的字符串搜索算法。它和 <abbr title="Knuth-Morris-Pratt 算法">KMP</abbr> 有着相同的原理。

第一步，我们把所有的模式串放到一个字典树里，以便根据扫描到的字符在模式串上切换。正如我刚提到的，AC 自动机和 KMP 工作原理相同。下一步是计算当发现不匹配字符时，应当向哪个位置跳转。和 KMP 没啥区别，只是用模式串字典树取代了单个模式串，这让其看起来就像一条边。我们称之为失配边。同时，还要设立一个前导数组用来标记失配路径（沿着失配边返回根节点的路径）上最后一个模式串，以便于快速找到模式串。之后我们扫描匹配串，在字典树上根据匹配串的字符移动指针。到达一个点后，根据前导数组来搜索已匹配的模式串。这就是 AC 自动机的工作原理。

## 代码

- [正解](HDU.2222.0.cpp)
